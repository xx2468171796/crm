# 桌面端（CRM Desktop）使用教程（项目主管 & 技术/上传者）

## 1. 安装与启动
- **获取安装包**：由管理员提供对应系统版本（Windows/macOS/Linux）。
- **安装**：按系统提示完成安装。
- **首次启动**：打开桌面端应用。

## 2. 登录
1. 打开应用后进入登录页。
2. 输入账号与密码。
3. 登录成功后进入主界面（项目列表/看板等）。

常见问题：
- **提示无权限**：联系管理员确认角色（项目主管/管理员/技术）。

## 3. 进入项目详情
1. 在项目列表/看板中选择一个项目。
2. 点击进入 **项目详情**。
3. 侧边栏可切换：
   - 概览
   - 动态表单
   - **交付物**
   - 沟通记录
   - 项目记录
   - 财务

## 4. 交付物模块（核心）
交付物分为三类：
- **客户文件**
- **作品文件**
- **模型文件**

页面支持 **树状视图** 与 **列表视图**（以实际按钮为准）。

### 4.1 上传文件（技术/上传者）
#### 上传单个文件
1. 进入项目详情 → **交付物**。
2. 在对应分类（客户文件/作品文件/模型文件）中选择上传入口（按钮或本地文件树操作）。
3. 选择本地文件。
4. 文件会进入上传队列并开始上传。
5. 上传完成后文件状态为：**待审核**。

#### 上传文件夹（如支持）
1. 选择本地文件夹。
2. 系统会扫描并将文件夹内文件加入上传队列。

### 4.2 下载文件（所有有权限用户）
1. 在文件条目上点击 **下载**。
2. 选择本地保存路径。
3. 等待下载完成提示。

### 4.3 预览文件（如支持）
1. 点击文件条目右侧的 **预览** 图标。
2. 若文件格式支持，将打开预览窗口或系统默认打开方式。

## 5. 审批文件（项目主管/管理员）
当文件状态为 **待审核** 时，项目主管/管理员可进行审批：

### 5.1 通过
1. 在待审核文件右侧点击 **通过**。
2. 系统提示“审批通过”。
3. 文件状态变更为：**已通过**。

### 5.2 驳回
1. 在待审核文件右侧点击 **驳回**。
2. 输入驳回原因（可选）。
3. 确认后，文件状态变更为：**已驳回**。

## 6. 被驳回文件重新提交（技术/上传者）
当文件状态为 **已驳回** 时，文件条目右侧会出现 **重新提交**。

### 6.1 单个重新提交
1. 找到状态为 **已驳回** 的文件。
2. 点击 **重新提交**。
3. 选择本地新的文件。
4. 系统会将新文件加入上传队列。
5. 新文件上传后会重新进入 **待审核** 状态。

> 说明：当前策略是“替换式重提”（旧记录会被删除并由新文件替代）。如果需要保留历史版本，请联系管理员升级版本化功能。

### 6.2 批量重新提交
1. 在同一分类下，勾选多个状态为 **已驳回** 的文件。
2. 点击顶部出现的 **批量重新提交(n)**。
3. 选择本地多个文件。
4. 系统会将所选文件依次加入上传队列。

建议使用方式：
- 批量选择时，建议你按顺序选取本地文件，避免误上传。

## 7. 文件管理（重命名/删除）
### 7.1 重命名
1. 在文件条目上点击 **重命名**。
2. 输入新文件名。
3. 保存后列表刷新。

权限规则（概念）：
- 上传者：一般仅能管理自己上传且处于 `pending/rejected` 的文件
- 管理员：权限更高

### 7.2 删除
1. 在文件条目上点击 **删除**。
2. 二次确认。
3. 删除成功后列表刷新。

### 7.3 批量删除
1. 勾选多个文件。
2. 点击 **批量删除(n)**。
3. 确认后删除。

## 8. 常见问题（FAQ）
- **为什么上传后是待审核？**
  - 文件需要项目主管/管理员审核后才能标记为通过。
- **为什么我看不到通过/驳回按钮？**
  - 你不是管理员/项目主管角色，或文件不处于待审核。
- **驳回后如何修改并重新提交？**
  - 在已驳回文件上点击“重新提交”，选择新的文件上传。

## 9. 项目主管流程图（Mermaid）
```mermaid
flowchart TD
  A[项目主管进入项目详情] --> B[打开交付物]
  B --> C[查看待审核文件列表]
  C --> D{逐个审核}

  D -->|通过| E[点击通过]
  E --> F[状态变更 approved]
  F --> C

  D -->|驳回| G[点击驳回]
  G --> H[填写驳回原因(可选)]
  H --> I[状态变更 rejected]
  I --> C

  I --> J[等待上传者重新提交]
  J --> C
```
