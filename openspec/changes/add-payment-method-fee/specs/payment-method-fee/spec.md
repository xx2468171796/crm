## ADDED Requirements

### Requirement: 支付方式手续费配置
系统 SHALL 允许管理员为每种支付方式配置手续费加成规则，支持固定金额和百分比两种方式。

#### Scenario: 配置固定金额手续费
- **WHEN** 管理员在支付方式管理页面编辑某支付方式
- **AND** 选择手续费类型为"固定金额"
- **AND** 输入固定金额值（如 5 元）
- **THEN** 系统保存该支付方式的手续费配置
- **AND** 后续使用该支付方式收款时自动加上固定金额

#### Scenario: 配置百分比手续费
- **WHEN** 管理员在支付方式管理页面编辑某支付方式
- **AND** 选择手续费类型为"百分比"
- **AND** 输入百分比值（如 3%）
- **THEN** 系统保存该支付方式的手续费配置
- **AND** 后续使用该支付方式收款时自动按百分比计算加成

#### Scenario: 不配置手续费
- **WHEN** 管理员在支付方式管理页面编辑某支付方式
- **AND** 手续费类型选择"无"或留空
- **THEN** 该支付方式收款时不产生手续费加成

### Requirement: 收款时自动计算手续费
系统 SHALL 在收款登记时根据选择的支付方式自动计算并显示手续费加成金额。

#### Scenario: 收款时显示手续费计算
- **WHEN** 财务人员在收款登记页面输入收款金额
- **AND** 选择一个配置了手续费的支付方式
- **THEN** 系统自动计算手续费加成金额
- **AND** 显示"原金额 + 手续费 = 最终金额"的形式
- **AND** 用户可以看到原金额和加成后的金额

#### Scenario: 切换支付方式时重新计算
- **WHEN** 财务人员在收款登记页面切换支付方式
- **THEN** 系统根据新选择的支付方式重新计算手续费
- **AND** 实时更新显示的手续费和最终金额

### Requirement: 收款记录保存手续费信息
系统 SHALL 在保存收款记录时同时保存原金额和手续费加成金额。

#### Scenario: 保存收款记录包含手续费
- **WHEN** 财务人员提交收款登记
- **THEN** 系统保存原收款金额（amount_received）
- **AND** 保存手续费加成金额（fee_amount）
- **AND** 保存手续费类型（fee_type: fixed/percent/none）
- **AND** 保存手续费配置值（fee_value）

### Requirement: 手续费报表
系统 SHALL 提供手续费报表页面，按收款方式统计原金额和手续费加成情况。

#### Scenario: 查看手续费报表
- **WHEN** 财务人员访问手续费报表页面
- **THEN** 系统显示按收款方式分组的统计数据
- **AND** 每种收款方式显示：收款笔数、原金额合计、手续费合计
- **AND** 支持按日期范围筛选

#### Scenario: 报表明细展示
- **WHEN** 财务人员在手续费报表中点击某收款方式
- **THEN** 系统展开显示该收款方式的收款明细列表
- **AND** 每条明细显示：收款日期、客户、原金额、手续费、最终金额
