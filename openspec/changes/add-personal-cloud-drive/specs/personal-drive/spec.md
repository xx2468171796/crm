# Capability: 个人网盘系统

## ADDED Requirements

### Requirement: 个人网盘空间
系统 SHALL 为每个用户提供独立的网盘存储空间。

#### Scenario: 用户访问个人网盘
- **WHEN** 用户在桌面端点击"我的网盘"
- **THEN** 系统显示用户的网盘文件列表
- **AND** 显示已用空间和总空间
- **AND** 文件按文件夹结构组织

#### Scenario: 文件存储路径
- **WHEN** 用户上传文件到网盘
- **THEN** 文件存储在S3路径 `部门/用户名/网盘文件/` 下
- **AND** 记录文件元信息到数据库

### Requirement: 网盘文件管理
系统 SHALL 支持用户对网盘文件进行基本管理操作。

#### Scenario: 上传文件
- **WHEN** 用户拖拽或选择文件上传
- **THEN** 系统将文件存储到用户网盘
- **AND** 更新已用空间统计

#### Scenario: 下载文件
- **WHEN** 用户点击下载按钮
- **THEN** 系统提供文件下载

#### Scenario: 删除文件
- **WHEN** 用户删除文件
- **THEN** 系统从存储中移除文件
- **AND** 释放已用空间

### Requirement: 网盘分享链接
系统 SHALL 支持生成分享链接让他人上传文件到用户网盘。

#### Scenario: 生成分享链接
- **WHEN** 用户点击"生成分享链接"按钮
- **THEN** 系统显示链接设置弹窗
- **AND** 用户可设置密码（可选）
- **AND** 用户可设置访问次数限制（可选）
- **AND** 用户可设置有效期（默认7天）

#### Scenario: 通过分享链接上传
- **WHEN** 访问者打开分享链接并上传文件
- **THEN** 文件自动重命名为 `分享+原文件名+时间戳`
- **AND** 文件存储到用户网盘
- **AND** 更新已用空间

### Requirement: 网盘容量管理
系统 SHALL 支持管理员设置和管理用户网盘容量。

#### Scenario: 默认容量
- **WHEN** 新用户首次访问网盘
- **THEN** 系统自动分配默认50GB存储空间

#### Scenario: 管理员调整容量
- **WHEN** 管理员在后台修改用户存储上限
- **THEN** 用户的可用空间相应调整

#### Scenario: 超出容量限制
- **WHEN** 用户上传文件超出容量限制
- **THEN** 系统拒绝上传
- **AND** 显示空间不足提示

### Requirement: 后台文件管理
系统 SHALL 允许管理员在后台管理所有用户的网盘文件。

#### Scenario: 查看用户网盘
- **WHEN** 管理员在后台选择查看某用户网盘
- **THEN** 系统显示该用户的所有文件

#### Scenario: 管理员删除文件
- **WHEN** 管理员删除用户文件
- **THEN** 文件从存储中移除
- **AND** 用户不会收到通知

#### Scenario: 管理员上传文件
- **WHEN** 管理员为用户上传文件
- **THEN** 文件存储到用户网盘
- **AND** 用户可以看到该文件
